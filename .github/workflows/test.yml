name: Validar Presença da Palavra "alter" no Meio da Linha do Conteúdo do PR

on:
  pull_request:
    types:
      - opened
      - synchronize

jobs:
  validar-conteudo:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout do código
        uses: actions/checkout@v2
        with:
         fetch-depth: 0

      - name: Verificar Conteúdo do PR
        run: |
          palavra_chave="alter"  # Substitua pela palavra que você deseja verificar
          encontrada=false

          for arquivo in $(git diff --name-only ${{ github.event.before }} ${{ github.sha }}); do
            if grep -q $palavra_chave $arquivo; then
              echo "Encontrada a palavra '$palavra_chave' no arquivo: $arquivo"
              encontrada=true
            fi
          done

          if [ "$encontrada" == true ]; then
            echo "::error::A palavra '$palavra_chave' foi encontrada em um ou mais arquivos. Por favor, remova antes de fazer o merge."
            exit 1
          fi
